<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DWS 101 - Exercise 4 - Part A</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="exercise4a_files/libs/clipboard/clipboard.min.js"></script>
<script src="exercise4a_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="exercise4a_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="exercise4a_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="exercise4a_files/libs/quarto-html/popper.min.js"></script>
<script src="exercise4a_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="exercise4a_files/libs/quarto-html/anchor.min.js"></script>
<link href="exercise4a_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="exercise4a_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="exercise4a_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="exercise4a_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="exercise4a_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
</script>
<script type="module">import "https://cdn.plot.ly/plotly-3.2.0.min"</script>



</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="exercise4a.ipynb" download="exercise4a.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DWS 101 - Exercise 4 - Part A</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="μεταφόρτωση-βιβλιοθηκών" class="level3">
<h3 class="anchored" data-anchor-id="μεταφόρτωση-βιβλιοθηκών">Μεταφόρτωση Βιβλιοθηκών</h3>
<p>Let’s start by importing our libraries:</p>
<div id="f5dc1067" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># για το γράφημα</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># train and test</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>And define our color visualization settings:</p>
<div id="c9db9893" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>px.defaults.template <span class="op">=</span> <span class="st">"plotly_white"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>color_palette <span class="op">=</span> [<span class="st">'#26C6DA'</span>, <span class="st">'#7a0e00'</span>, <span class="st">'#FF7043'</span>, <span class="st">'#2E78D2'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="ερώτημα-1" class="level3">
<h3 class="anchored" data-anchor-id="ερώτημα-1">Ερώτημα 1</h3>
<p><em>Φορτώστε το σύνολο δεδομένων wine-missing.csv σε ένα DataFrame μέσω της βιβλιοθήκης pandas.</em></p>
<div id="25a8c615" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_raw <span class="op">=</span> pd.read_csv(<span class="st">"data/wine-missing.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df_raw.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">fixed acidity</th>
<th data-quarto-table-cell-role="th">volatile acidity</th>
<th data-quarto-table-cell-role="th">citric acid</th>
<th data-quarto-table-cell-role="th">residual sugar</th>
<th data-quarto-table-cell-role="th">chlorides</th>
<th data-quarto-table-cell-role="th">free sulfur dioxide</th>
<th data-quarto-table-cell-role="th">total sulfur dioxide</th>
<th data-quarto-table-cell-role="th">density</th>
<th data-quarto-table-cell-role="th">pH</th>
<th data-quarto-table-cell-role="th">sulphates</th>
<th data-quarto-table-cell-role="th">alcohol</th>
<th data-quarto-table-cell-role="th">quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>white</td>
<td>7.0</td>
<td>0.27</td>
<td>0.36</td>
<td>20.7</td>
<td>0.045</td>
<td>45.0</td>
<td>170.0</td>
<td>1.0010</td>
<td>3.00</td>
<td>0.45</td>
<td>8.8</td>
<td>6</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>unknown</td>
<td>6.3</td>
<td>0.30</td>
<td>0.34</td>
<td>1.6</td>
<td>0.049</td>
<td>14.0</td>
<td>132.0</td>
<td>0.9940</td>
<td>3.30</td>
<td>0.49</td>
<td>9.5</td>
<td>6</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>white</td>
<td>8.1</td>
<td>0.28</td>
<td>0.40</td>
<td>6.9</td>
<td>0.050</td>
<td>30.0</td>
<td>97.0</td>
<td>0.9951</td>
<td>3.26</td>
<td>0.44</td>
<td>10.1</td>
<td>6</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>unknown</td>
<td>7.2</td>
<td>0.23</td>
<td>0.32</td>
<td>8.5</td>
<td>0.058</td>
<td>47.0</td>
<td>186.0</td>
<td>0.9956</td>
<td>3.19</td>
<td>0.40</td>
<td>9.9</td>
<td>6</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>unknown</td>
<td>7.2</td>
<td>0.23</td>
<td>0.32</td>
<td>8.5</td>
<td>0.058</td>
<td>47.0</td>
<td>186.0</td>
<td>0.9956</td>
<td>3.19</td>
<td>0.40</td>
<td>9.9</td>
<td>6</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><em>Στη συνέχεια, περιγράψτε το κάθε χαρακτηριστικό και δημιουργήστε το αντίστοιχο ιστόγραμμα τους.</em></p>
<div id="d67ba7d7" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_raw.describe()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">fixed acidity</th>
<th data-quarto-table-cell-role="th">volatile acidity</th>
<th data-quarto-table-cell-role="th">citric acid</th>
<th data-quarto-table-cell-role="th">residual sugar</th>
<th data-quarto-table-cell-role="th">chlorides</th>
<th data-quarto-table-cell-role="th">free sulfur dioxide</th>
<th data-quarto-table-cell-role="th">total sulfur dioxide</th>
<th data-quarto-table-cell-role="th">density</th>
<th data-quarto-table-cell-role="th">pH</th>
<th data-quarto-table-cell-role="th">sulphates</th>
<th data-quarto-table-cell-role="th">alcohol</th>
<th data-quarto-table-cell-role="th">quality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>6487.000000</td>
<td>6489.000000</td>
<td>6494.000000</td>
<td>6495.000000</td>
<td>6495.000000</td>
<td>6497.000000</td>
<td>6497.000000</td>
<td>6497.000000</td>
<td>6488.000000</td>
<td>6493.000000</td>
<td>6497.000000</td>
<td>6497.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>7.216579</td>
<td>0.339691</td>
<td>0.318722</td>
<td>5.444326</td>
<td>0.056042</td>
<td>30.525319</td>
<td>115.744574</td>
<td>0.994697</td>
<td>3.218395</td>
<td>0.531215</td>
<td>10.491801</td>
<td>5.818378</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>1.296750</td>
<td>0.164649</td>
<td>0.145265</td>
<td>4.758125</td>
<td>0.035036</td>
<td>17.749400</td>
<td>56.521855</td>
<td>0.002999</td>
<td>0.160748</td>
<td>0.148814</td>
<td>1.192712</td>
<td>0.873255</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>3.800000</td>
<td>0.080000</td>
<td>0.000000</td>
<td>0.600000</td>
<td>0.009000</td>
<td>1.000000</td>
<td>6.000000</td>
<td>0.987110</td>
<td>2.720000</td>
<td>0.220000</td>
<td>8.000000</td>
<td>3.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>6.400000</td>
<td>0.230000</td>
<td>0.250000</td>
<td>1.800000</td>
<td>0.038000</td>
<td>17.000000</td>
<td>77.000000</td>
<td>0.992340</td>
<td>3.110000</td>
<td>0.430000</td>
<td>9.500000</td>
<td>5.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>7.000000</td>
<td>0.290000</td>
<td>0.310000</td>
<td>3.000000</td>
<td>0.047000</td>
<td>29.000000</td>
<td>118.000000</td>
<td>0.994890</td>
<td>3.210000</td>
<td>0.510000</td>
<td>10.300000</td>
<td>6.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>7.700000</td>
<td>0.400000</td>
<td>0.390000</td>
<td>8.100000</td>
<td>0.065000</td>
<td>41.000000</td>
<td>156.000000</td>
<td>0.996990</td>
<td>3.320000</td>
<td>0.600000</td>
<td>11.300000</td>
<td>6.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>15.900000</td>
<td>1.580000</td>
<td>1.660000</td>
<td>65.800000</td>
<td>0.611000</td>
<td>289.000000</td>
<td>440.000000</td>
<td>1.038980</td>
<td>4.010000</td>
<td>2.000000</td>
<td>14.900000</td>
<td>9.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ae3df8dd" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df_raw.info()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 6497 entries, 0 to 6496
Data columns (total 13 columns):
 #   Column                Non-Null Count  Dtype  
---  ------                --------------  -----  
 0   type                  6497 non-null   object 
 1   fixed acidity         6487 non-null   float64
 2   volatile acidity      6489 non-null   float64
 3   citric acid           6494 non-null   float64
 4   residual sugar        6495 non-null   float64
 5   chlorides             6495 non-null   float64
 6   free sulfur dioxide   6497 non-null   float64
 7   total sulfur dioxide  6497 non-null   float64
 8   density               6497 non-null   float64
 9   pH                    6488 non-null   float64
 10  sulphates             6493 non-null   float64
 11  alcohol               6497 non-null   float64
 12  quality               6497 non-null   int64  
dtypes: float64(11), int64(1), object(1)
memory usage: 660.0+ KB</code></pre>
</div>
</div>
<p>Επομένως τα types των επιμέρους στηλών είναι σωστά. Διαχωρίζω τώρα τις μεταβλητές στα ανεξάρτητα χαρακτηριστικά και την εξαρτημένη μεταβλητή <code>type</code>:</p>
<div id="5bb0f687" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df_X <span class="op">=</span> df_raw.drop(labels <span class="op">=</span> <span class="st">"type"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df_y <span class="op">=</span> df_raw[[<span class="st">"type"</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6ef30b23" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Παίρνω τα ονόματα των στηλών που θέλω να δείξω στο ιστόγραμμα</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>column_names <span class="op">=</span> df_X.columns</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">6</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">12</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># για να το μετατρέψω από πίνακα σε διάνυσμα</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, column <span class="kw">in</span> <span class="bu">enumerate</span>(column_names):</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    axes[i].hist(df_X[column], bins<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span>color_palette[<span class="dv">0</span>], edgecolor<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    axes[i].set_title(column)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># df_X.shape</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="exercise4a_files/figure-html/cell-8-output-1.png" width="758" height="1142" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>Σχολιασμός</strong></p>
<ul>
<li>Οι κατανομές των fixed acidity, volatile acidity, citric acid, residual sugar, chlorides, free &amp; total sulfur dioxide και sulphates παρουσιάζουν θετική λοξότητα, δηλαδή τα περισσότερα κρασιά παρουσιάζουν σχετικά χαμηλές τιμές, και λιγότερα είναι αυτά με μεγαλύτερες τιμές.</li>
<li>Το residual sugar συγκεκριμένα, φαίνεται να έχει λογαριθμική κατανομή.</li>
<li>Density και pH έχουν κατανομή που πλησιάζει την κανονική. Η πυκνότητα φαίνεται να έχει μάλιστα ένα περιορισμένο εύρος τιμών [0.989 - 1.002].</li>
<li>Η ποιότητα είναι διακριτή μεταβλητή, με τις περισσότερες τιμές να είναι 5, 6 ή 7.</li>
</ul>
<p><em>Για τη μεταβλητή Type, να δημιουργηθεί ραβδόγραμμα για τις τιμές white, red και unknown, όπου unknown είναι άγνωστο αν τα δείγματα κρασιού ήταν λευκά ή κόκκινα.</em></p>
<div id="4f3c75c5" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.bar(df_y, x<span class="op">=</span><span class="st">'type'</span>, title<span class="op">=</span><span class="st">"Type of Wine - Count"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>fig.update_traces(<span class="bu">dict</span>(marker_line_width<span class="op">=</span><span class="dv">0</span>), marker_color<span class="op">=</span>color_palette[<span class="dv">0</span>])</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.2.0.min.js" integrity="sha256-iZ2u/oU2wf/vDbl/ChcX93WgbBRSBvUO6N413hDz7xM=" crossorigin="anonymous"></script>                <div id="2538e1d1-08d9-4eda-96ae-b717a053cab7" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("2538e1d1-08d9-4eda-96ae-b717a053cab7")) {                    Plotly.newPlot(                        "2538e1d1-08d9-4eda-96ae-b717a053cab7",                        [{"hovertemplate":"type=%{x}\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#26C6DA","pattern":{"shape":""},"line":{"width":0}},"name":"","orientation":"v","showlegend":false,"textposition":"auto","x":["white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","white","unknown","white","unknown","white","white","white","white","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","unknown","white","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","white","white","white","unknown","white","white","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","unknown","white","unknown","white","white","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","white","white","white","white","unknown","white","unknown","white","white","unknown","white","white","unknown","white","white","unknown","white","white","white","unknown","white","white","white","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","white","white","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","white","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","white","unknown","white","unknown","white","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","white","white","white","unknown","unknown","white","unknown","white","unknown","unknown","white","unknown","unknown","white","white","white","unknown","white","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","white","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","white","white","white","white","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","white","unknown","unknown","white","white","white","white","white","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","white","white","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","white","unknown","white","white","unknown","white","unknown","unknown","unknown","white","white","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","white","white","unknown","unknown","unknown","white","unknown","white","white","unknown","white","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","white","unknown","white","white","white","unknown","white","white","unknown","white","unknown","white","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","white","white","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","white","unknown","white","unknown","white","white","white","unknown","unknown","white","white","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","white","white","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","white","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","white","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","white","unknown","white","white","unknown","unknown","white","white","white","unknown","unknown","white","white","unknown","unknown","white","white","white","white","unknown","unknown","white","unknown","unknown","white","unknown","unknown","white","white","white","white","unknown","white","unknown","white","white","unknown","unknown","white","unknown","white","white","unknown","unknown","white","white","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","white","white","white","unknown","white","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","white","white","white","white","white","unknown","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","white","unknown","unknown","unknown","white","white","white","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","white","unknown","white","unknown","white","unknown","unknown","white","unknown","white","white","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","unknown","white","unknown","white","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","white","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","white","unknown","white","unknown","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","white","white","unknown","unknown","white","white","unknown","white","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","white","white","white","white","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","white","white","white","unknown","white","unknown","white","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","white","white","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","white","white","unknown","unknown","white","white","unknown","white","white","unknown","white","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","white","unknown","unknown","unknown","white","white","white","white","white","white","unknown","white","white","white","white","unknown","unknown","white","white","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","white","unknown","white","white","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","white","white","white","white","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","white","white","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","white","unknown","white","white","unknown","unknown","unknown","unknown","white","white","white","white","white","unknown","white","unknown","white","unknown","white","unknown","white","white","unknown","white","white","white","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","white","unknown","white","white","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","white","white","unknown","white","unknown","unknown","unknown","white","white","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","white","white","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","white","white","white","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","white","white","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","white","white","unknown","unknown","white","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","white","unknown","unknown","unknown","white","white","white","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","white","unknown","unknown","white","unknown","unknown","white","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","white","white","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","white","white","unknown","unknown","white","white","unknown","white","white","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","white","white","white","white","unknown","unknown","white","unknown","white","unknown","white","white","white","white","white","unknown","unknown","white","unknown","unknown","white","white","white","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","white","unknown","white","unknown","white","white","white","unknown","white","white","white","white","white","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","white","unknown","unknown","white","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","white","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","white","unknown","unknown","white","unknown","white","unknown","unknown","white","unknown","white","white","white","white","white","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","white","unknown","white","white","unknown","white","unknown","unknown","unknown","white","white","white","unknown","white","white","white","unknown","white","unknown","white","white","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","white","unknown","white","white","white","unknown","white","white","white","unknown","white","white","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","white","white","white","unknown","white","unknown","unknown","unknown","white","unknown","white","white","unknown","white","unknown","white","unknown","unknown","white","white","white","unknown","white","white","white","unknown","white","white","unknown","white","white","white","white","unknown","white","white","white","unknown","white","unknown","unknown","unknown","white","white","white","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","white","unknown","white","white","white","white","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","white","unknown","unknown","white","white","unknown","white","unknown","white","white","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","white","white","unknown","white","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","white","white","white","unknown","white","unknown","white","white","white","unknown","unknown","unknown","white","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","white","white","white","white","white","white","white","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","white","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","white","white","white","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","white","unknown","unknown","white","unknown","unknown","white","white","white","unknown","unknown","white","white","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","white","white","unknown","white","unknown","white","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","white","white","white","white","unknown","unknown","white","white","white","white","unknown","unknown","white","unknown","white","unknown","white","white","unknown","white","unknown","white","unknown","white","unknown","white","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","white","white","unknown","white","unknown","white","white","white","white","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","white","unknown","unknown","white","white","unknown","unknown","white","unknown","white","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","white","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","white","white","unknown","unknown","white","unknown","white","white","white","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","white","white","white","white","white","white","white","unknown","white","unknown","white","white","white","unknown","unknown","white","white","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","white","white","white","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","white","unknown","white","white","white","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","white","white","white","unknown","unknown","white","white","unknown","unknown","unknown","white","white","white","unknown","white","white","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","white","white","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","white","white","unknown","white","white","white","unknown","white","unknown","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","white","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","white","white","white","unknown","unknown","white","unknown","unknown","white","unknown","white","white","white","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","white","white","unknown","white","unknown","white","unknown","white","white","unknown","white","white","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","white","white","unknown","white","unknown","white","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","white","white","unknown","white","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","white","white","unknown","white","white","unknown","white","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","white","unknown","white","white","white","unknown","unknown","white","white","unknown","white","unknown","white","unknown","white","white","unknown","white","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","white","unknown","unknown","unknown","white","white","unknown","white","white","unknown","white","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","white","unknown","white","white","white","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","unknown","white","unknown","white","white","unknown","white","white","white","white","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","white","white","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","white","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","white","white","unknown","unknown","white","white","unknown","unknown","unknown","white","unknown","unknown","white","white","white","unknown","white","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","white","unknown","white","unknown","unknown","unknown","unknown","white","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","white","white","white","white","white","unknown","unknown","white","unknown","white","white","unknown","white","white","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","unknown","white","white","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","white","unknown","white","white","white","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","white","unknown","white","white","unknown","white","white","white","white","white","unknown","unknown","white","white","unknown","unknown","white","white","white","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","white","white","white","white","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","white","white","white","unknown","unknown","white","white","unknown","unknown","unknown","white","white","white","white","unknown","white","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","white","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","white","white","white","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","white","white","white","unknown","unknown","white","unknown","unknown","white","unknown","white","unknown","unknown","white","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","white","unknown","white","white","white","white","white","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","white","unknown","white","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","white","white","white","white","white","white","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","white","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","unknown","unknown","white","unknown","white","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","unknown","white","unknown","white","white","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","white","unknown","white","white","white","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","unknown","white","white","white","unknown","unknown","unknown","white","unknown","unknown","white","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","white","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","unknown","white","white","unknown","white","unknown","white","white","white","unknown","white","white","white","white","unknown","unknown","white","unknown","unknown","white","white","white","unknown","unknown","white","white","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","white","white","white","white","unknown","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","unknown","white","white","unknown","white","white","unknown","white","white","white","white","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","white","unknown","white","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","white","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","white","white","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","white","unknown","unknown","white","unknown","white","unknown","unknown","white","unknown","unknown","white","unknown","white","white","white","unknown","unknown","unknown","white","white","unknown","unknown","unknown","white","white","white","white","white","unknown","white","unknown","unknown","white","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","white","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","white","white","unknown","white","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","white","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","unknown","unknown","white","white","white","unknown","white","white","white","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","white","white","unknown","unknown","white","white","white","white","white","white","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","white","white","white","unknown","white","unknown","unknown","white","unknown","unknown","white","white","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","white","white","white","unknown","unknown","unknown","white","white","white","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","white","white","unknown","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","unknown","unknown","white","white","white","white","white","unknown","unknown","white","unknown","unknown","white","white","white","unknown","white","white","white","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","white","unknown","unknown","unknown","unknown","unknown","white","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","unknown","unknown","unknown","unknown","white","white","white","white","white","unknown","white","white","unknown","white","white","unknown","white","white","white","unknown","unknown","white","unknown","white","unknown","white","white","unknown","white","unknown","unknown","white","unknown","unknown","unknown","unknown","unknown","unknown","unknown","white","white","white","white","unknown","unknown","white","unknown","unknown","unknown","white","unknown","unknown","white","white","unknown","white","white","white","white","white","white","white","white","unknown","white","unknown","unknown","unknown","white","white","white","unknown","white","white","unknown","white","unknown","white","unknown","unknown","unknown","unknown","white","unknown","unknown","white","unknown","unknown","white","white","white","unknown","white","white","unknown","white","white","white","unknown","white","white","unknown","white","unknown","white","white","white","unknown","unknown","white","unknown","red","red","unknown","unknown","red","unknown","unknown","red","unknown","unknown","unknown","unknown","unknown","unknown","red","red","unknown","unknown","red","unknown","red","red","unknown","unknown","red","red","unknown","unknown","red","red","unknown","red","unknown","red","unknown","unknown","red","unknown","red","unknown","unknown","unknown","red","red","red","red","red","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","red","unknown","red","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","red","unknown","red","unknown","red","red","unknown","unknown","unknown","unknown","unknown","red","unknown","red","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","unknown","unknown","unknown","red","red","unknown","red","red","unknown","unknown","unknown","red","unknown","unknown","unknown","unknown","red","unknown","unknown","unknown","red","unknown","unknown","red","red","red","unknown","red","unknown","red","unknown","unknown","unknown","red","red","red","unknown","unknown","unknown","red","red","red","unknown","red","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","red","unknown","red","red","red","unknown","red","unknown","red","red","unknown","red","red","unknown","red","unknown","red","unknown","unknown","unknown","red","red","unknown","unknown","unknown","red","unknown","red","unknown","red","red","unknown","red","red","unknown","red","unknown","unknown","red","unknown","unknown","red","red","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","red","unknown","red","unknown","unknown","unknown","red","unknown","unknown","red","unknown","unknown","red","red","unknown","red","red","red","unknown","unknown","red","unknown","red","unknown","red","red","unknown","red","red","unknown","unknown","unknown","red","red","unknown","red","unknown","unknown","red","unknown","unknown","unknown","unknown","red","unknown","unknown","red","unknown","red","red","red","unknown","red","unknown","unknown","red","red","red","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","red","unknown","unknown","red","unknown","unknown","red","unknown","red","red","red","unknown","unknown","unknown","red","red","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","red","red","unknown","unknown","red","unknown","red","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","red","unknown","unknown","red","red","red","red","unknown","unknown","unknown","unknown","red","unknown","unknown","red","red","unknown","unknown","unknown","unknown","red","red","unknown","unknown","red","red","unknown","unknown","unknown","red","red","red","unknown","red","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","unknown","red","red","red","unknown","red","unknown","red","unknown","red","red","red","unknown","unknown","red","unknown","red","unknown","red","unknown","unknown","red","red","red","red","unknown","red","unknown","unknown","red","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","red","unknown","unknown","red","red","unknown","unknown","unknown","red","unknown","unknown","red","unknown","unknown","unknown","unknown","red","red","red","red","unknown","red","red","red","unknown","unknown","red","unknown","unknown","red","unknown","unknown","unknown","red","unknown","red","unknown","red","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","red","unknown","unknown","unknown","red","unknown","unknown","unknown","unknown","unknown","red","red","unknown","unknown","red","unknown","red","unknown","red","unknown","unknown","red","unknown","unknown","unknown","red","unknown","red","red","red","red","unknown","unknown","unknown","unknown","red","red","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","red","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","red","red","red","unknown","unknown","unknown","red","red","unknown","red","unknown","unknown","red","unknown","red","red","red","unknown","red","red","red","unknown","unknown","red","unknown","red","unknown","red","unknown","unknown","unknown","unknown","unknown","red","red","unknown","unknown","unknown","unknown","unknown","red","red","unknown","red","unknown","red","red","unknown","unknown","unknown","unknown","unknown","red","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","red","red","red","unknown","unknown","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","red","unknown","unknown","red","unknown","red","unknown","red","red","unknown","unknown","unknown","red","unknown","unknown","unknown","unknown","red","red","unknown","unknown","unknown","red","red","unknown","unknown","red","red","red","unknown","unknown","unknown","red","unknown","red","red","unknown","unknown","red","unknown","unknown","red","unknown","red","red","unknown","unknown","red","unknown","unknown","red","unknown","unknown","unknown","red","unknown","unknown","unknown","unknown","red","unknown","unknown","red","unknown","unknown","red","unknown","unknown","red","red","unknown","unknown","unknown","red","red","red","unknown","unknown","unknown","unknown","unknown","unknown","red","red","red","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","red","red","unknown","unknown","red","unknown","unknown","red","unknown","unknown","red","unknown","red","red","red","unknown","unknown","unknown","red","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","red","unknown","unknown","unknown","unknown","unknown","red","unknown","red","red","red","red","unknown","unknown","unknown","red","red","unknown","unknown","unknown","unknown","red","red","unknown","unknown","unknown","red","unknown","red","unknown","unknown","unknown","red","red","red","unknown","unknown","red","unknown","unknown","unknown","red","unknown","red","unknown","red","unknown","red","unknown","unknown","red","unknown","red","unknown","red","unknown","red","unknown","unknown","unknown","unknown","unknown","unknown","red","red","unknown","unknown","red","unknown","red","unknown","unknown","unknown","unknown","unknown","red","unknown","red","red","unknown","unknown","red","red","unknown","unknown","unknown","red","unknown","red","red","red","unknown","unknown","unknown","red","unknown","unknown","red","unknown","red","red","unknown","unknown","unknown","unknown","red","unknown","unknown","red","unknown","unknown","unknown","red","unknown","unknown","unknown","red","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","red","unknown","unknown","red","red","red","red","unknown","red","unknown","red","red","red","unknown","unknown","red","red","red","red","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","unknown","unknown","unknown","red","unknown","red","red","unknown","red","unknown","red","unknown","red","unknown","red","unknown","red","unknown","unknown","red","red","unknown","unknown","red","red","red","unknown","red","unknown","unknown","red","unknown","unknown","unknown","red","unknown","unknown","red","red","unknown","unknown","unknown","red","unknown","red","unknown","red","unknown","red","red","unknown","red","red","unknown","unknown","red","red","unknown","red","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","unknown","unknown","red","unknown","unknown","unknown","red","red","red","unknown","unknown","unknown","red","red","unknown","unknown","unknown","unknown","red","unknown","red","red","unknown","red","unknown","unknown","unknown","unknown","red","unknown","red","unknown","red","unknown","red","unknown","unknown","red","red","red","unknown","red","unknown","unknown","unknown","red","unknown","red","red","red","unknown","unknown","unknown","unknown","red","red","unknown","unknown","unknown","unknown","unknown","unknown","red","red","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","red","red","unknown","red","red","unknown","unknown","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","red","unknown","red","red","unknown","unknown","red","unknown","unknown","unknown","unknown","unknown","red","unknown","red","red","unknown","unknown","red","unknown","red","unknown","unknown","red","unknown","unknown","unknown","red","unknown","unknown","red","red","red","red","unknown","red","unknown","red","unknown","unknown","unknown","unknown","red","red","red","unknown","unknown","unknown","red","unknown","unknown","unknown","unknown","red","unknown","unknown","red","red","red","red","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","red","unknown","unknown","red","unknown","red","unknown","red","red","unknown","unknown","red","unknown","red","red","unknown","unknown","unknown","unknown","red","unknown","unknown","red","red","red","unknown","unknown","unknown","red","red","unknown","unknown","red","red","red","unknown","unknown","red","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","red","unknown","red","red","unknown","red","red","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","red","red","red","unknown","unknown","red","red","red","unknown","unknown","unknown","red","red","unknown","unknown","red","unknown","red","unknown","red","unknown","unknown","red","unknown","unknown","red","red","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","red","unknown","unknown","red","red","unknown","red","red","red","red","unknown","unknown","unknown","unknown","unknown","unknown","red","red","red","unknown","unknown","red","unknown","red","unknown","unknown","unknown","unknown","red","unknown","red","unknown","unknown","red","unknown","red","unknown","unknown","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","red","red","red","unknown","red","red","unknown","red","unknown","red","unknown","unknown","unknown","unknown","unknown","red","red","unknown","unknown","unknown","red","red","unknown","unknown","red","unknown","red","unknown","unknown","unknown","red","unknown","red","unknown","red","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","red","red","red","red","unknown","unknown","unknown","unknown","unknown","red","unknown","red","unknown","unknown","red","unknown","unknown","red","red","unknown","unknown","unknown","red","red","red","unknown","red","unknown","red","red","unknown","red","unknown","unknown","red","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","red","unknown","unknown","red","unknown","red","red","red","red","unknown","red","unknown","unknown","unknown","unknown","unknown","red","red","unknown","unknown","red","unknown","unknown","red","red","red","unknown","unknown","red","red","unknown","unknown","unknown","red","unknown","red","unknown","unknown","unknown","red","red","red","red","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","unknown","red","unknown","unknown","unknown","red","unknown","unknown","unknown","red","red","unknown","unknown","unknown","unknown","unknown","red","unknown","red","red","unknown","red","unknown","red","unknown","unknown","red","unknown","unknown","unknown","red","unknown","red","unknown","unknown","unknown","red","unknown","unknown","red","unknown","unknown","red","unknown","red","red","unknown","unknown","unknown","unknown","red","unknown","red","unknown","red","unknown","unknown","unknown","red","unknown","unknown","unknown","red","unknown","red","unknown","red","red","red","unknown","red","unknown","unknown","red","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","unknown","unknown","red","unknown","unknown","red","unknown","unknown","unknown","red","unknown","unknown","red","red","red","unknown","red","red","red","red","unknown","red","red","red","red","unknown","unknown","unknown","red","unknown","red","red","unknown","red","red","red","red","unknown","red","unknown","red","unknown","red","unknown","unknown","red","unknown","unknown","red","red","unknown","unknown","unknown","unknown","red","red","unknown","red","red","unknown","red","unknown","unknown","red","unknown","unknown","unknown","red","red","red","red","unknown","unknown","red","unknown","red","red","unknown","unknown","red","red","red","unknown","red","red","unknown","red","red","unknown","unknown","red","red","unknown","red","unknown","unknown","unknown","unknown","unknown","unknown","unknown","red","unknown","red","unknown","unknown","red","unknown","unknown","red","unknown","unknown","red","unknown","red","unknown","red","red","unknown","red","unknown","unknown","red","unknown","red","red","red","unknown","red","unknown","red","unknown","unknown","unknown","red","unknown","unknown","red","red","unknown","red","red"],"xaxis":"x","y":{"dtype":"i1","bdata":"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQE="},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"type"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"count"}},"legend":{"tracegroupgap":0},"title":{"text":"Type of Wine - Count"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('2538e1d1-08d9-4eda-96ae-b717a053cab7');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div id="6fb6d689" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_raw[<span class="st">'type'</span>].value_counts())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>type
unknown    3898
white      1959
red         640
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>Παρατηρώ πως έχω πολύ περισσότερες άγνωστες τιμές (n = 3898) έναντι white (1959) και red (640).</p>
</section>
<section id="ερώτημα-2" class="level3">
<h3 class="anchored" data-anchor-id="ερώτημα-2">Ερώτημα 2</h3>
<p><em>Μετατρέψτε τις τιμές white/red/unknown σε 0/1/2 αντίστοιχα.</em></p>
<div id="101779c0" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'future.no_silent_downcasting'</span>, <span class="va">True</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>pd.options.mode.copy_on_write <span class="op">=</span> <span class="va">True</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print(df_y['type'].isnull().sum())</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>df_y[<span class="st">'type'</span>] <span class="op">=</span> df_y[<span class="st">'type'</span>].replace({<span class="st">'white'</span>: <span class="dv">0</span>, <span class="st">'red'</span>: <span class="dv">1</span>, <span class="st">'unknown'</span>: <span class="dv">2</span>}).astype(<span class="bu">int</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print(df_y['type'].unique())</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><em>Έπειτα, δημιουργήστε numpy arrays x (inputs), y (targets), με x να είναι όλες οι μεταβλητές εκτός του type και y το type.</em></p>
<div id="42b69b01" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Το drop(labels = "type") το είχα ήδη κάνει νωρίτερα</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_X.to_numpy()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x.shape)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_y.to_numpy()</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(y))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y.shape)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># x.shape</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'numpy.ndarray'&gt;
(6497, 12)
&lt;class 'numpy.ndarray'&gt;
(6497, 1)</code></pre>
</div>
</div>
</section>
<section id="ερώτημα-3" class="level3">
<h3 class="anchored" data-anchor-id="ερώτημα-3">Ερώτημα 3</h3>
<p><em>Δημιουργήστε 2 διαφορετικά σύνολα δεδομένων: (1) (x_known, y_known) και (2) x_unknown. Το 1o σύνολο δεδομένων περιέχει όλα τα ζεύγη (inputs, targets) στα οποία είναι γνωστή η μεταβλητή type (white/red), ενώ στο 2ο είναι όλα τα inputs που το target είναι unknown.</em></p>
<p>Ξεκινάω από το σύνολο (1) (x_known, y_known). Η μεταβλητή y είναι unknown όταν είναι ίση με το 2, επομένως έχω:</p>
<div id="5ff5f74f" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># φιλτράρω το df_X, για τις 2 περιπτώσεις:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>x_known <span class="op">=</span> df_X[((y <span class="op">==</span> <span class="dv">0</span>) <span class="op">|</span> (y <span class="op">==</span> <span class="dv">1</span>))]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>y_known <span class="op">=</span> df_y[((y <span class="op">==</span> <span class="dv">0</span>) <span class="op">|</span> (y <span class="op">==</span> <span class="dv">1</span>))]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Για το σύνολο (2) x_unknown έχω:</p>
<div id="221a7ed0" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># τα άγνωστα x</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>x_unknown <span class="op">=</span> df_X[(y <span class="op">==</span> <span class="dv">2</span>)]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>x_unknown_array <span class="op">=</span> x_unknown.to_numpy()</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Initial df is size </span><span class="sc">{</span>df_X<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">.</span><span class="ch">\n</span><span class="ss">The df where the type of wine is known is of shape </span><span class="sc">{</span>x_known<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">.</span><span class="ch">\n</span><span class="ss">The df where the type of wine is unknown is of shape </span><span class="sc">{</span>x_unknown<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initial df is size (6497, 12).
The df where the type of wine is known is of shape (2599, 12).
The df where the type of wine is unknown is of shape (3898, 12).</code></pre>
</div>
</div>
</section>
<section id="ερώτημα-4" class="level3">
<h3 class="anchored" data-anchor-id="ερώτημα-4">Ερώτημα 4</h3>
<p><em>Για το 1o σύνολο δεδομένων, χρησιμοποιήστε τη συνάρτηση train_test_split(), ώστε να χωρίσετε τα δεδομένα σας σε train-test με ποσοστό 70-30 αντίστοιχα. Θέστε με random_state=42 και την επιλογή stratify=True, ώστε υπάρχει το ίδιο ποσοστό κάθε κλάσης στα train και test αντίστοιχα.</em></p>
<p>Από το documentation διαβάζω πως το stratify χρησιμοποιείται για να πετύχω κατά προσέγγιση παρόμοια αναλογία των τιμών y στα υποσύνολα training και test sets. Επιτυγχάνεται περνώντας την τιμή stratify=y:</p>
<div id="b70df1fb" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the DataFrames to NumPy arrays, to use in train test split</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>x_known_array <span class="op">=</span> x_known.to_numpy()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>y_known_array <span class="op">=</span> y_known.to_numpy()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># παίρνω τα x_known, y_know, για να εκπαιδεύσω το μοντέλο μου</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    x_known_array, y_known_array, test_size<span class="op">=</span><span class="fl">0.30</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>y_known)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="ερώτημα-5" class="level3">
<h3 class="anchored" data-anchor-id="ερώτημα-5">Ερώτημα 5</h3>
<p><em>Εκπαιδεύστε ταξινομητή Random Forest με random_state=42 στο train set.</em></p>
<p>To y_train έχει 2 διαστάσεις στην υπάρχουσα μορφή του shape=(1819, 1), δηλαδή 1819 γραμμές και 1 στήλη. Επειδή ο ταξινομητής χρειάζεται μονοδιάστατο πίνακα, θα χρησιμοποιήσω τη μέθοδο ravel() για να αφαιρέσω τη διάσταση της στήλης (shape=(1819,)).</p>
<div id="c5a7cbfa" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the model</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>rf_classifier <span class="op">=</span> RandomForestClassifier(max_depth<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># train it on the training data</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>rf_classifier.fit(X_train, y_train.ravel())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-1 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  display: none;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  display: block;
  width: 100%;
  overflow: visible;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}

.estimator-table summary {
    padding: .5rem;
    font-family: monospace;
    cursor: pointer;
}

.estimator-table details[open] {
    padding-left: 0.1rem;
    padding-right: 0.1rem;
    padding-bottom: 0.3rem;
}

.estimator-table .parameters-table {
    margin-left: auto !important;
    margin-right: auto !important;
}

.estimator-table .parameters-table tr:nth-child(odd) {
    background-color: #fff;
}

.estimator-table .parameters-table tr:nth-child(even) {
    background-color: #f6f6f6;
}

.estimator-table .parameters-table tr:hover {
    background-color: #e0e0e0;
}

.estimator-table table td {
    border: 1px solid rgba(106, 105, 104, 0.232);
}

.user-set td {
    color:rgb(255, 94, 0);
    text-align: left;
}

.user-set td.value pre {
    color:rgb(255, 94, 0) !important;
    background-color: transparent !important;
}

.default td {
    color: black;
    text-align: left;
}

.user-set td i,
.default td i {
    color: black;
}

.copy-paste-icon {
    background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NDggNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNy4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjUgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTIwOCAwTDMzMi4xIDBjMTIuNyAwIDI0LjkgNS4xIDMzLjkgMTQuMWw2Ny45IDY3LjljOSA5IDE0LjEgMjEuMiAxNC4xIDMzLjlMNDQ4IDMzNmMwIDI2LjUtMjEuNSA0OC00OCA0OGwtMTkyIDBjLTI2LjUgMC00OC0yMS41LTQ4LTQ4bDAtMjg4YzAtMjYuNSAyMS41LTQ4IDQ4LTQ4ek00OCAxMjhsODAgMCAwIDY0LTY0IDAgMCAyNTYgMTkyIDAgMC0zMiA2NCAwIDAgNDhjMCAyNi41LTIxLjUgNDgtNDggNDhMNDggNTEyYy0yNi41IDAtNDgtMjEuNS00OC00OEwwIDE3NmMwLTI2LjUgMjEuNS00OCA0OC00OHoiLz48L3N2Zz4=);
    background-repeat: no-repeat;
    background-size: 14px 14px;
    background-position: 0;
    display: inline-block;
    width: 14px;
    height: 14px;
    cursor: pointer;
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestClassifier(max_depth=5, random_state=0)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>RandomForestClassifier</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.7/modules/generated/sklearn.ensemble.RandomForestClassifier.html">?<span>Documentation for RandomForestClassifier</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted" data-param-prefix="">
        <div class="estimator-table">
            <details>
                <summary>Parameters</summary>
                
<table class="parameters-table caption-top table table-sm table-striped small">
<tbody>
<tr class="default odd">
<td><em></em></td>
<td class="param">n_estimators&nbsp;</td>
<td class="value">100</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">criterion&nbsp;</td>
<td class="value">'gini'</td>
</tr>
<tr class="user-set odd">
<td><em></em></td>
<td class="param">max_depth&nbsp;</td>
<td class="value">5</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">min_samples_split&nbsp;</td>
<td class="value">2</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">min_samples_leaf&nbsp;</td>
<td class="value">1</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">min_weight_fraction_leaf&nbsp;</td>
<td class="value">0.0</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">max_features&nbsp;</td>
<td class="value">'sqrt'</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">max_leaf_nodes&nbsp;</td>
<td class="value">None</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">min_impurity_decrease&nbsp;</td>
<td class="value">0.0</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">bootstrap&nbsp;</td>
<td class="value">True</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">oob_score&nbsp;</td>
<td class="value">False</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">n_jobs&nbsp;</td>
<td class="value">None</td>
</tr>
<tr class="user-set odd">
<td><em></em></td>
<td class="param">random_state&nbsp;</td>
<td class="value">0</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">verbose&nbsp;</td>
<td class="value">0</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">warm_start&nbsp;</td>
<td class="value">False</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">class_weight&nbsp;</td>
<td class="value">None</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">ccp_alpha&nbsp;</td>
<td class="value">0.0</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">max_samples&nbsp;</td>
<td class="value">None</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">monotonic_cst&nbsp;</td>
<td class="value">None</td>
</tr>
</tbody>
</table>

            </details>
        </div>
    </div></div></div></div></div><script>function copyToClipboard(text, element) {
    // Get the parameter prefix from the closest toggleable content
    const toggleableContent = element.closest('.sk-toggleable__content');
    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
    const fullParamName = paramPrefix ? `${paramPrefix}${text}` : text;

    const originalStyle = element.style;
    const computedStyle = window.getComputedStyle(element);
    const originalWidth = computedStyle.width;
    const originalHTML = element.innerHTML.replace('Copied!', '');

    navigator.clipboard.writeText(fullParamName)
        .then(() => {
            element.style.width = originalWidth;
            element.style.color = 'green';
            element.innerHTML = "Copied!";

            setTimeout(() => {
                element.innerHTML = originalHTML;
                element.style = originalStyle;
            }, 2000);
        })
        .catch(err => {
            console.error('Failed to copy:', err);
            element.style.color = 'red';
            element.innerHTML = "Failed!";
            setTimeout(() => {
                element.innerHTML = originalHTML;
                element.style = originalStyle;
            }, 2000);
        });
    return false;
}

document.querySelectorAll('.fa-regular.fa-copy').forEach(function(element) {
    const toggleableContent = element.closest('.sk-toggleable__content');
    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
    const paramName = element.parentElement.nextElementSibling.textContent.trim();
    const fullParamName = paramPrefix ? `${paramPrefix}${paramName}` : paramName;

    element.setAttribute('title', fullParamName);
});
</script>
</div>
</div>
<p><em>Yπολογίστε την ακρίβεια (accuracy), f1-score, precision και recall, στα train και test sets.</em></p>
<p>Ας ξεκινήσουμε με τους ορισμούς των μετρικών αποτίμησης αποτελεσματικότητας που μας ζητούνται από την εκφώνηση:</p>
<ul>
<li><p>tp (True Positive): αριθμός σωστών θετικών προβλέψεων (π.χ. προβλέψαμε Positive και ήταν Positive)</p></li>
<li><p>tn (True Negative): αριθμός σωστών αρνητικών προβλέψεων (π.χ. προβλέψαμε Negative και ήταν Negative)</p></li>
<li><p>fp (False Positive): αριθμός λανθασμένων θετικών προβλέψεων (π.χ. προβλέψαμε Positive και ήταν Negative)</p></li>
<li><p>fn (False Negative): αριθμός λανθασμένων αρνητικών προβλέψεων (π.χ. προβλέψαμε Negative και ήταν Positive)</p></li>
<li><p>Ευκρίνεια (Precision): Αξιοπιστία του μοντέλου ως προς μια συγκεκριμένη κλάση (είθισται την θετική) δηλαδή πόσες από τις θετικές προβλέψεις ήταν πράγματι θετικές περιπτώσεις <code>(tp / (tp + fp))</code>.</p></li>
<li><p>Ακρίβεια (Accuracy): Πόσο καλά το μοντέλο μας εντοπίζει και τις δύο κλάσεις, δηλαδή <code>(tp + tn) / (tp + tn + fp + fn)</code>.</p></li>
<li><p>Ανάκληση (Recall): Πόσο καλά το μοντέλο μας εντοπίζει (ανακαλεί) όλες τις θετικές περιπτώσεις, δηλαδή ο λόγος των θετικών προβλέψεων προς όλες τις θετικές περιπτώσεις που υπήρχαν στο σύνολο δεδομένων <code>(tp / (tp + fn))</code>.</p></li>
<li><p>F1 score: ο αρμονικός μέσος των 2 τιμών της ευκρίνειας και της ανάκλησης, δηλαδή <code>2 / ((1 / precision) + (1 / recall))</code></p></li>
</ul>
<section id="train-set" class="level4">
<h4 class="anchored" data-anchor-id="train-set">Train set</h4>
<div id="3d835e83" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predictions for the train set</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>y_pred_train <span class="op">=</span> rf_classifier.predict(X_train)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>cm_train <span class="op">=</span> confusion_matrix(y_train, y_pred_train)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cm_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1370    1]
 [  10  438]]</code></pre>
</div>
</div>
<p>Από το documentation της confusion_matrix έχω:</p>
<ul>
<li><p>true negatives is C(0,0), άρα tn = 1366</p></li>
<li><p>false negatives is C(1,0), άρα fn = 35</p></li>
<li><p>true positives is C(1,1), άρα tp = 413</p></li>
<li><p>false positives is C(0,1), άρα fp = 5</p></li>
</ul>
<pre><code>[tn, fp]
[fn, tp]</code></pre>
<p>Και επειδή η ravel() στην προεπιλογή της (order=‘C’) επιπεδώνει τους πίνακες διαβάζοντας κατά γραμμές:</p>
<div id="9fbda42d" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>tn, fp, fn, tp <span class="op">=</span> cm_train.ravel().tolist()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Οπότε για το training set έχω τις παρακάτω μετρικές:</p>
<div id="21929471" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>train_accuracy <span class="op">=</span> (tp <span class="op">+</span> tn) <span class="op">/</span> (tp <span class="op">+</span> tn <span class="op">+</span> fp <span class="op">+</span> fn)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>train_precision <span class="op">=</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fp))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>train_recall <span class="op">=</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fn))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>train_f1_score <span class="op">=</span> <span class="dv">2</span> <span class="op">/</span> ((<span class="dv">1</span> <span class="op">/</span> train_precision) <span class="op">+</span> (<span class="dv">1</span> <span class="op">/</span> train_recall))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>df_train_metrics <span class="op">=</span> pd.DataFrame({</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'train_accuracy'</span>: train_accuracy, </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'train_precision'</span>: train_precision,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'train_recall'</span>: train_recall,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'train_f1_score'</span>: train_f1_score,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    },index<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>df_train_metrics</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">train_accuracy</th>
<th data-quarto-table-cell-role="th">train_precision</th>
<th data-quarto-table-cell-role="th">train_recall</th>
<th data-quarto-table-cell-role="th">train_f1_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>0.993953</td>
<td>0.997722</td>
<td>0.977679</td>
<td>0.987599</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Παρατηρώ πως έχω υψηλή ακρίβεια (99.3%) και ελαφρώς χαμηλότερο ικανότητα να εντοπιστούν όλα τα δείγματα του “red” (recall = 97.7%), που είναι για την περίπτωσή μας το target με τιμή 1 και διαβάζεται ως η «θετική τιμή» στα αποτελέσματα.</p>
</section>
<section id="test-set" class="level4">
<h4 class="anchored" data-anchor-id="test-set">Test set</h4>
<p>Επαναλαμβάνω την παραπάνω διαδικασία, αλλά για τα δεδομένα test:</p>
<div id="cfc195f8" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predictions for the test set</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>y_pred_test <span class="op">=</span> rf_classifier.predict(X_test)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, y_pred_test)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cm_test)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>tn, fp, fn, tp <span class="op">=</span> cm_test.ravel().tolist()</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>test_accuracy <span class="op">=</span> (tp <span class="op">+</span> tn) <span class="op">/</span> (tp <span class="op">+</span> tn <span class="op">+</span> fp <span class="op">+</span> fn)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>test_precision <span class="op">=</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fp))</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>test_recall <span class="op">=</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fn))</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>test_f1_score <span class="op">=</span> <span class="dv">2</span> <span class="op">/</span> ((<span class="dv">1</span> <span class="op">/</span> test_precision) <span class="op">+</span> (<span class="dv">1</span> <span class="op">/</span> test_recall))</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>df_test_metrics <span class="op">=</span> pd.DataFrame({</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'test_accuracy'</span>: test_accuracy, </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'test_precision'</span>: test_precision,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'test_recall'</span>: test_recall,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'test_f1_score'</span>: test_f1_score,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    },index<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>df_test_metrics</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[587   1]
 [  2 190]]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">test_accuracy</th>
<th data-quarto-table-cell-role="th">test_precision</th>
<th data-quarto-table-cell-role="th">test_recall</th>
<th data-quarto-table-cell-role="th">test_f1_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>0.996154</td>
<td>0.994764</td>
<td>0.989583</td>
<td>0.992167</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Παρατηρώ πως τόσο η ακρίβεια (99.6%) όσο και η ανάκληση (99.0%) αυξάνονται στο test.</p>
<p><em>Ποιά από τις 2 μετρικές είναι περισσότερο αντιπροσωπευτική στο dataset: Accuracy ή F1; Αιτιολογείστε.</em></p>
<p>Στο ραβδόγραμμα παρατηρήσαμε πως στα δεδομένα μου έχω περίπου 3 φορές περισσότερες τιμές white (1959) έναντι red (640). Εξ’ ορισμού, γνωρίζω πως η ακρίβεια ως μετρική λαμβάνει υπόψιν την ικανότητα του μοντέλου να προβλέπει τόσο τόσο τις αρνητικές (έστω red) όσο και τις θετικές τιμές (έστω white), καθότι τις εμπεριέχει και στον τύπο της:</p>
<p><code>accuracy = (tp + tn) / (tp + tn + fp + fn)</code></p>
<p>Οπότε σε ένα ισορροπημένο δείγμα πληθυσμού θα μας δώσει μια καλή εκτίμηση για την ικανότητα του μοντέλου να προβλέπει και τα δύο τιμές. Όμως όταν η αναλογία των τιμών της μεταβλητής εξόδου δεν είναι είναι ισορροπημένη, η ακρίβεια έχει υψηλές τιμές εξ’ ορισμού της. Παραδείγματος χάριν, εάν στην περίπτωσή μας έθετα όλες τις προβλέψεις y ίσες με την τιμή της πολυπληθέστερης ομάδας ‘white’, θα έπαιρνα ακρίβεια 75.4% ως προς την ‘white’, βασιζόμενο στις τιμές της ‘white’ και χωρίς να έχει προβλέψει σωστά καμία τιμή της ‘red’.</p>
<p>Από την άλλη, ο αρμονικός μέσος είναι ένα μέτρο απόδοσης που χρησιμοποιεί ταυτόχρονα την ευκρίνεια (precision) και την ανάκληση (recall).</p>
<p><code>f1_score = 2 / ((1 / precision) + (1 / recall))</code></p>
<p>Η μεν ευκρίνεια (PPV: Positive Predictive Value) μετρά την ικανότητα να έχω «καθαρές» προβλέψεις μιας ομάδας, να έχω μεγαλύτερη βεβαιότητα δηλαδή πως ένα θετικό δείγμα είναι πράγματι θετικό. Αυξάνεται δηλαδή όταν αυξάνονται τα λάθος χαρακτηρισμένα δείγματα από την άλλη ομάδα.</p>
<p><code>precision = (tp / (tp + fp))</code></p>
<p>Η ανάκληση, από την άλλη, μετρά την ικανότητα να εντοπιστούν όλα τα δείγματα από μια ομάδα, ασχέτως αν αυξάνονται τα λάθος χαρακτηρισμένα δείγματα από την άλλη ομάδα (που ίσχυε στο PPV). Αυξάνεται όταν μειώνονται τα false negative <code>fn</code>, δηλαδή όταν το μοντέλο καταφέρνει να μην «αστοχεί» στον εντοπισμό των θετικών τιμών.</p>
<p><code>recall = (tp / (tp + fn))</code></p>
<p>Πρόκειται δηλαδή για δύο μετρικές που έχουν αντίστροφη σχέση: αυξάνοντας τη μια μειώνεται η άλλη. Άρα, εφόσον τις λαμβάνει υπόψιν και τις δύο ο αρμονικός μέσος, στο συγκεκριμένο δείγμα θα έδειχνε πως το υποθετικό μοντέλο μας με όλες τις προβλέψεις y ίσες με την τιμή της πολυπληθέστερης ομάδας ‘white’ δεν κάνει σωστές προβλέψεις, που είναι και η πραγματικότητα.</p>
</section>
</section>
<section id="ερώτημα-6" class="level3">
<h3 class="anchored" data-anchor-id="ερώτημα-6">Ερώτημα 6</h3>
<p><em>Επανεκπαιδεύστε το Random Forest με random_state=42, θέτοντας την παράμετρο class_weight=’balanced’. Να εξηγήσετε σύμφωνα με το documentation τι κάνει η παράμετρος.</em></p>
<p><strong>Κριτήριο διαχωρισμού στο Random Forest</strong></p>
<p>Το μοντέλο του Random Forest χρησιμοποιεί (ως προεπιλογή) το κριτήριο διαχωρισμού Gini σε έναν κόμβο, το οποίο προσδιορίζει πόση αβεβαιότητα θα προκύψει από τους πιθανούς διαχωρισμούς των δειγμάτων που βρίσκονται σε έναν κόμβο, ανάλογα με τα κριτήρια (ερωτήσεις) που θα εφαρμοστούν. Η τιμή Gini δίνεται από τον τύπο:</p>
<p>Gini = 1 − Σ[p(j|t)]^2</p>
<p>Όπου p(j|t) η σχετική συχνότητα της κλάσης t στον κόμβο j. Όσο μικρότερη τιμή Gini προκύπτει για έναν διαχωρισμό, τόσο πιο καθαρές θα είναι οι υποομάδες που προκύπτουν. Αυτό γιατί το γεγονός πως υψώνουμε στο τετράγωνο την σχετική συχνότητα σημαίνει πως μεγαλώνει η επίδραση που έχει μια υψηλή συχνότητα στην μείωση της τιμής. Παραδείγματος χάριν:</p>
<p>Περίπτωση Α: Για συχνότητες 0.5 και 0.5 θα είχα: 1-0.5<sup>2-0.5</sup>2 = 0.5 ενώ Περίπτωση Β: Για συχνότητες 0.9 και 0.1 θα είχα: 1-0.9<sup>2-0.1</sup>2 = 0.18</p>
<p>Παρατηρώ πως ο πιο καθαρός διαχωρισμός της περίπτωσης Β οδηγεί σε μικρότερη τιμή Gini 0.18 &lt; 0.50.</p>
<p><strong>Class Weighing</strong></p>
<p>Σύμφωνα με το documentation, η παράμετρος αυτή ελέγχει τα βάρη που αναλογούν σε στις εκατέρωθεν συχνότητες σε έναν κόμβο διαχωρισμού. Όταν εφαρμόζω Class Weighing, αυξάνω τεχνητά, με αντιστρόφως ανάλογο τρόπο, το βάρος της ευάριθμης ομάδας, οδηγώντας α) σε λιγότερο καθαρό διαχωρισμό β) μικρότερες τιμές Gini όταν η ευάριθμη ομάδα γίνεται πιο καθαρή (καθώς έχει τώρα αυξημένο βάρος). Αυτή η επιπλέον «δυσκολία» που βάζω στο μοντέλο μου, έχει ως αποτέλεσμα να λαμβάνεται περισσότερο υπόψιν ο διαχωρισμός της ευάριθμης ομάδας, εξισσοροπώντας την μικρότερη παρουσία της επί συνόλου των δεδομένων.</p>
<p><strong>Εφαρμογή στο παράδειγμά μας</strong></p>
<p>Τρέχω καταρχήν το μοντέλο αλλάζοντας την παράμετρο <code>class_weight</code>, ακολουθώντας τα βήματα όμοια με πριν:</p>
<div id="2160b0ba" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the model</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>rf_classifier_balanced <span class="op">=</span> RandomForestClassifier(max_depth<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">0</span>, class_weight<span class="op">=</span><span class="st">'balanced'</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># train it on the training data</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>rf_classifier_balanced.fit(X_train, y_train.ravel())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-2 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  display: none;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  display: block;
  width: 100%;
  overflow: visible;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}

.estimator-table summary {
    padding: .5rem;
    font-family: monospace;
    cursor: pointer;
}

.estimator-table details[open] {
    padding-left: 0.1rem;
    padding-right: 0.1rem;
    padding-bottom: 0.3rem;
}

.estimator-table .parameters-table {
    margin-left: auto !important;
    margin-right: auto !important;
}

.estimator-table .parameters-table tr:nth-child(odd) {
    background-color: #fff;
}

.estimator-table .parameters-table tr:nth-child(even) {
    background-color: #f6f6f6;
}

.estimator-table .parameters-table tr:hover {
    background-color: #e0e0e0;
}

.estimator-table table td {
    border: 1px solid rgba(106, 105, 104, 0.232);
}

.user-set td {
    color:rgb(255, 94, 0);
    text-align: left;
}

.user-set td.value pre {
    color:rgb(255, 94, 0) !important;
    background-color: transparent !important;
}

.default td {
    color: black;
    text-align: left;
}

.user-set td i,
.default td i {
    color: black;
}

.copy-paste-icon {
    background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NDggNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNy4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjUgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTIwOCAwTDMzMi4xIDBjMTIuNyAwIDI0LjkgNS4xIDMzLjkgMTQuMWw2Ny45IDY3LjljOSA5IDE0LjEgMjEuMiAxNC4xIDMzLjlMNDQ4IDMzNmMwIDI2LjUtMjEuNSA0OC00OCA0OGwtMTkyIDBjLTI2LjUgMC00OC0yMS41LTQ4LTQ4bDAtMjg4YzAtMjYuNSAyMS41LTQ4IDQ4LTQ4ek00OCAxMjhsODAgMCAwIDY0LTY0IDAgMCAyNTYgMTkyIDAgMC0zMiA2NCAwIDAgNDhjMCAyNi41LTIxLjUgNDgtNDggNDhMNDggNTEyYy0yNi41IDAtNDgtMjEuNS00OC00OEwwIDE3NmMwLTI2LjUgMjEuNS00OCA0OC00OHoiLz48L3N2Zz4=);
    background-repeat: no-repeat;
    background-size: 14px 14px;
    background-position: 0;
    display: inline-block;
    width: 14px;
    height: 14px;
    cursor: pointer;
}
</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestClassifier(class_weight='balanced', max_depth=5, random_state=0)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked=""><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>RandomForestClassifier</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.7/modules/generated/sklearn.ensemble.RandomForestClassifier.html">?<span>Documentation for RandomForestClassifier</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted" data-param-prefix="">
        <div class="estimator-table">
            <details>
                <summary>Parameters</summary>
                
<table class="parameters-table caption-top table table-sm table-striped small">
<tbody>
<tr class="default odd">
<td><em></em></td>
<td class="param">n_estimators&nbsp;</td>
<td class="value">100</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">criterion&nbsp;</td>
<td class="value">'gini'</td>
</tr>
<tr class="user-set odd">
<td><em></em></td>
<td class="param">max_depth&nbsp;</td>
<td class="value">5</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">min_samples_split&nbsp;</td>
<td class="value">2</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">min_samples_leaf&nbsp;</td>
<td class="value">1</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">min_weight_fraction_leaf&nbsp;</td>
<td class="value">0.0</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">max_features&nbsp;</td>
<td class="value">'sqrt'</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">max_leaf_nodes&nbsp;</td>
<td class="value">None</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">min_impurity_decrease&nbsp;</td>
<td class="value">0.0</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">bootstrap&nbsp;</td>
<td class="value">True</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">oob_score&nbsp;</td>
<td class="value">False</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">n_jobs&nbsp;</td>
<td class="value">None</td>
</tr>
<tr class="user-set odd">
<td><em></em></td>
<td class="param">random_state&nbsp;</td>
<td class="value">0</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">verbose&nbsp;</td>
<td class="value">0</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">warm_start&nbsp;</td>
<td class="value">False</td>
</tr>
<tr class="user-set even">
<td><em></em></td>
<td class="param">class_weight&nbsp;</td>
<td class="value">'balanced'</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">ccp_alpha&nbsp;</td>
<td class="value">0.0</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">max_samples&nbsp;</td>
<td class="value">None</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">monotonic_cst&nbsp;</td>
<td class="value">None</td>
</tr>
</tbody>
</table>

            </details>
        </div>
    </div></div></div></div></div><script>function copyToClipboard(text, element) {
    // Get the parameter prefix from the closest toggleable content
    const toggleableContent = element.closest('.sk-toggleable__content');
    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
    const fullParamName = paramPrefix ? `${paramPrefix}${text}` : text;

    const originalStyle = element.style;
    const computedStyle = window.getComputedStyle(element);
    const originalWidth = computedStyle.width;
    const originalHTML = element.innerHTML.replace('Copied!', '');

    navigator.clipboard.writeText(fullParamName)
        .then(() => {
            element.style.width = originalWidth;
            element.style.color = 'green';
            element.innerHTML = "Copied!";

            setTimeout(() => {
                element.innerHTML = originalHTML;
                element.style = originalStyle;
            }, 2000);
        })
        .catch(err => {
            console.error('Failed to copy:', err);
            element.style.color = 'red';
            element.innerHTML = "Failed!";
            setTimeout(() => {
                element.innerHTML = originalHTML;
                element.style = originalStyle;
            }, 2000);
        });
    return false;
}

document.querySelectorAll('.fa-regular.fa-copy').forEach(function(element) {
    const toggleableContent = element.closest('.sk-toggleable__content');
    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
    const paramName = element.parentElement.nextElementSibling.textContent.trim();
    const fullParamName = paramPrefix ? `${paramPrefix}${paramName}` : paramName;

    element.setAttribute('title', fullParamName);
});
</script>
</div>
</div>
<p>Υπολογισμός για το train set:</p>
<div id="7e45ccf7" class="cell" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predictions for the train set</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>y_pred_train <span class="op">=</span> rf_classifier_balanced.predict(X_train)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>cm_train <span class="op">=</span> confusion_matrix(y_train, y_pred_train)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>tn, fp, fn, tp <span class="op">=</span> cm_train.ravel().tolist()</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>train_accuracy <span class="op">=</span> (tp <span class="op">+</span> tn) <span class="op">/</span> (tp <span class="op">+</span> tn <span class="op">+</span> fp <span class="op">+</span> fn)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>train_precision <span class="op">=</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fp))</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>train_recall <span class="op">=</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fn))</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>train_f1_score <span class="op">=</span> <span class="dv">2</span> <span class="op">/</span> ((<span class="dv">1</span> <span class="op">/</span> train_precision) <span class="op">+</span> (<span class="dv">1</span> <span class="op">/</span> train_recall))</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>df_train_metrics_balanced <span class="op">=</span> pd.DataFrame({</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'train_accuracy'</span>: train_accuracy, </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'train_precision'</span>: train_precision,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'train_recall'</span>: train_recall,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'train_f1_score'</span>: train_f1_score,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    },index<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>df_train_metrics_balanced</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">train_accuracy</th>
<th data-quarto-table-cell-role="th">train_precision</th>
<th data-quarto-table-cell-role="th">train_recall</th>
<th data-quarto-table-cell-role="th">train_f1_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>0.995052</td>
<td>0.991051</td>
<td>0.988839</td>
<td>0.989944</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Παρατηρώ πως βελτιώνεται τόσο η ακρίβεια (99.3% -&gt; 99.5%) όσο και η ανάκληση για τον τύπο “red” (97.7% -&gt; 90.0%).</p>
<p>Υπολογισμός για το test set:</p>
<div id="6cb34623" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predictions for the test set</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>y_pred_test <span class="op">=</span> rf_classifier.predict(X_test)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, y_pred_test)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cm_test)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>tn, fp, fn, tp <span class="op">=</span> cm_test.ravel().tolist()</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>test_accuracy <span class="op">=</span> (tp <span class="op">+</span> tn) <span class="op">/</span> (tp <span class="op">+</span> tn <span class="op">+</span> fp <span class="op">+</span> fn)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>test_precision <span class="op">=</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fp))</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>test_recall <span class="op">=</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fn))</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>test_f1_score <span class="op">=</span> <span class="dv">2</span> <span class="op">/</span> ((<span class="dv">1</span> <span class="op">/</span> test_precision) <span class="op">+</span> (<span class="dv">1</span> <span class="op">/</span> test_recall))</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>df_test_metrics_balanced <span class="op">=</span> pd.DataFrame({</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'test_accuracy'</span>: test_accuracy, </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'test_precision'</span>: test_precision,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'test_recall'</span>: test_recall,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'test_f1_score'</span>: test_f1_score,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    },index<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>df_test_metrics_balanced</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[587   1]
 [  2 190]]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">test_accuracy</th>
<th data-quarto-table-cell-role="th">test_precision</th>
<th data-quarto-table-cell-role="th">test_recall</th>
<th data-quarto-table-cell-role="th">test_f1_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>0.996154</td>
<td>0.994764</td>
<td>0.989583</td>
<td>0.992167</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Παρατηρώ πως τόσο η ακρίβεια (99.6%) όσο και η ανάκληση (99.0%) παραμένουν ίδιες στο μοντέλο με τα weighted averages στο test.</p>
</section>
<section id="ερώτημα-7" class="level3">
<h3 class="anchored" data-anchor-id="ερώτημα-7">Ερώτημα 7</h3>
<p><em>Χρησιμοποιήστε τον ταξινομητή του ερωτήματος 6 ώστε να υπολογίσετε τις πιθανότητες που δίνει το μοντέλο για την κλάση κάθε παραδείγματος στο σύνολο x_unknown (y_unknown_proba=model.predict_proba(x_unknown)).</em></p>
<p>Περνάω επομένως στο x_unknown (3898, 12):</p>
<div id="40fdaaa9" class="cell" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>y_unknown_proba <span class="op">=</span> rf_classifier.predict_proba(x_unknown)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"(y_unknown_proba is a </span><span class="sc">{</span><span class="bu">type</span>(y_unknown_proba)<span class="sc">}</span><span class="ss"> with dimensions </span><span class="sc">{</span>y_unknown_proba<span class="sc">.</span>shape<span class="sc">}</span><span class="ss"> and classes </span><span class="sc">{</span>rf_classifier<span class="sc">.</span>classes_<span class="sc">}</span><span class="ss">)."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(y_unknown_proba is a &lt;class 'numpy.ndarray'&gt; with dimensions (3898, 2) and classes [0 1]).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/anton/Desktop/Data Science/MSc Data and Web Science/DWS101 Μηχανική Μάθηση/DWS101-Machine-Learning/Exercise4/venv/lib/python3.14/site-packages/sklearn/utils/validation.py:2742: UserWarning:

X has feature names, but RandomForestClassifier was fitted without feature names
</code></pre>
</div>
</div>
<p>Όπου το y_unknown_proba είναι ένας πίνακας 2 διαστάσεων με 3898 γραμμές και 2 στήλες και για το οποίο ισχύει:</p>
<ul>
<li><p>Στήλη 0: Η πιθανότητα η μέτρηση να ανήκει στο ‘white’, καθώς την είχα θέσει ως κλάση 0.</p></li>
<li><p>Στήλη 1: Η πιθανότητα η μέτρηση να ανήκει στο ‘red’, καθώς την είχα θέσει ως κλάση 1.</p></li>
</ul>
</section>
<section id="ερώτημα-8" class="level3">
<h3 class="anchored" data-anchor-id="ερώτημα-8">Ερώτημα 8</h3>
<p><em>Δώστε την ετικέτα (y_unknown_pred) ‘red’ στα παραδειγμάτων του συνόλου x_unknown για τα οποία ισχύει y_unknown_proba &gt; 0.65. Παρομοίως, δώστε την ετικέτα ‘white’ στα παραδείγματα του συνόλου για τα οποία ισχύει x_unknown_proba &lt; 0.35</em></p>
<p>Θα δημιουργήσω ένα dataframe για την αποθήκευση των νέων τιμών, για να δουλέψω πιο εύκολα:</p>
<div id="27662711" class="cell" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create an empty dataframe</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>df_y_unknown_labelled <span class="op">=</span> pd.DataFrame()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># populate it</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>df_y_unknown_labelled[<span class="st">'type'</span>] <span class="op">=</span> [<span class="st">'red'</span> <span class="cf">if</span> x<span class="op">&gt;</span><span class="fl">0.65</span> <span class="cf">else</span> <span class="st">'white'</span> <span class="cf">if</span> x<span class="op">&lt;</span><span class="fl">0.35</span>  <span class="cf">else</span> <span class="st">'unknown'</span> <span class="cf">for</span> x <span class="kw">in</span> y_unknown_proba[:, <span class="dv">1</span>]]</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>column_counts <span class="op">=</span> df_y_unknown_labelled.<span class="bu">apply</span>(pd.Series.value_counts)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(column_counts)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_y_unknown_labelled.shape)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         type
type         
white    2938
red       905
unknown    55
(3898, 1)</code></pre>
</div>
</div>
<p>Άρα η αρχική ετικετοποίηση έχει πάει αρκετά καλά, αφήνοντας μόνο 55 σειρές δεδομένων με άγνωστο “type”.</p>
</section>
<section id="ερώτημα-9" class="level3">
<h3 class="anchored" data-anchor-id="ερώτημα-9">Ερώτημα 9</h3>
<p><em>Ενώστε τα σύνολα (x_train, y_train) του 1ου συνόλου με τα δεδομένα που επισημειώθηκαν με ετικέτες στο Ερώτημα 8.</em></p>
<p>Το σύνολο (1) είναι το (x_known, y_known). Αρχικά θέλω να ενώσω τα df_y_unknown_labelled με τα df_initial_labelled:</p>
<div id="e9b8c188" class="cell" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df_x_unknown <span class="op">=</span> pd.DataFrame(x_unknown)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>x_unknown.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>df_y_unknown_labelled.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>df_combined_labelled <span class="op">=</span> pd.concat([df_y_unknown_labelled, x_unknown], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>df_initial_labelled <span class="op">=</span> pd.concat([x_known, y_known], axis<span class="op">=</span><span class="dv">1</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns of df_initial_labelled to match df_combined_labelled</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>df_initial_labelled <span class="op">=</span> df_initial_labelled[df_combined_labelled.columns]</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># stack them</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>df_final <span class="op">=</span> pd.concat([df_combined_labelled, df_initial_labelled], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>df_final[<span class="st">'type'</span>] <span class="op">=</span> df_final[<span class="st">'type'</span>].replace({<span class="st">'white'</span>: <span class="dv">0</span>, <span class="st">'red'</span>: <span class="dv">1</span>, <span class="st">'unknown'</span>: <span class="dv">2</span>}).astype(<span class="bu">int</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>df_final.head()</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>df_final.info()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 6497 entries, 0 to 6496
Data columns (total 13 columns):
 #   Column                Non-Null Count  Dtype  
---  ------                --------------  -----  
 0   type                  6497 non-null   int64  
 1   fixed acidity         6487 non-null   float64
 2   volatile acidity      6489 non-null   float64
 3   citric acid           6494 non-null   float64
 4   residual sugar        6495 non-null   float64
 5   chlorides             6495 non-null   float64
 6   free sulfur dioxide   6497 non-null   float64
 7   total sulfur dioxide  6497 non-null   float64
 8   density               6497 non-null   float64
 9   pH                    6488 non-null   float64
 10  sulphates             6493 non-null   float64
 11  alcohol               6497 non-null   float64
 12  quality               6497 non-null   int64  
dtypes: float64(11), int64(2)
memory usage: 660.0 KB</code></pre>
</div>
</div>
<p>Και επαναλαμβάνω την αρχική διαδικασία, αυτή τη φορά στο <code>df_new</code>¨</p>
<div id="021c5e55" class="cell" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df_X <span class="op">=</span> df_final.drop(labels <span class="op">=</span> <span class="st">"type"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df_y <span class="op">=</span> df_final[[<span class="st">"type"</span>]]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_y[<span class="st">'type'</span>].unique())</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df_X.to_numpy()</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(x))</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x.shape)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_y.to_numpy()</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(y))</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y.shape)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0 2 1]
&lt;class 'numpy.ndarray'&gt;
(6497, 12)
&lt;class 'numpy.ndarray'&gt;
(6497, 1)</code></pre>
</div>
</div>
<p>Δημιουργώ πάλι το σύνολο (1) (x_known, y_known). Η μεταβλητή y είναι unknown όταν είναι ίση με το 2, επομένως έχω:</p>
<div id="fa05453d" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># φιλτράρω το df_X, για τις 2 περιπτώσεις:</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>x_known <span class="op">=</span> df_X[((y <span class="op">==</span> <span class="dv">0</span>) <span class="op">|</span> (y <span class="op">==</span> <span class="dv">1</span>))]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>y_known <span class="op">=</span> df_y[((y <span class="op">==</span> <span class="dv">0</span>) <span class="op">|</span> (y <span class="op">==</span> <span class="dv">1</span>))]</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>x_known.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>(6442, 12)</code></pre>
</div>
</div>
<p>Για το σύνολο (2) x_unknown έχω:</p>
<div id="f6712ac9" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># τα άγνωστα x</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>x_unknown <span class="op">=</span> df_X[(y <span class="op">==</span> <span class="dv">2</span>)]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>x_unknown_array <span class="op">=</span> x_unknown.to_numpy()</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Initial df is size </span><span class="sc">{</span>df_X<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">.</span><span class="ch">\n</span><span class="ss">The df where the type of wine is known is of shape </span><span class="sc">{</span>x_known<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">.</span><span class="ch">\n</span><span class="ss">The df where the type of wine is unknown is of shape </span><span class="sc">{</span>x_unknown<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initial df is size (6497, 12).
The df where the type of wine is known is of shape (6442, 12).
The df where the type of wine is unknown is of shape (55, 12).</code></pre>
</div>
</div>
<div id="625cc1c3" class="cell" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the DataFrames to NumPy arrays, to use in train test split</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>x_known_array <span class="op">=</span> x_known.to_numpy()</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>y_known_array <span class="op">=</span> y_known.to_numpy()</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># χωρίζω τα x_known_array, y_known_array για να εκπαιδεύσω το μοντέλο μου</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    x_known_array, y_known_array, test_size<span class="op">=</span><span class="fl">0.30</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>y_known)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Και επαναλαμβάνω την εκπαίδευση στο Random Forest:</p>
<div id="a315327f" class="cell" data-execution_count="30">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>rf_classifier_balanced <span class="op">=</span> RandomForestClassifier(max_depth<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">0</span>, class_weight<span class="op">=</span><span class="st">'balanced'</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># train it on the training data</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>rf_classifier_balanced.fit(X_train, y_train.ravel())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<style>#sk-container-id-3 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-3 {
  color: var(--sklearn-color-text);
}

#sk-container-id-3 pre {
  padding: 0;
}

#sk-container-id-3 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-3 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-3 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-3 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-3 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-3 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-3 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-3 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-3 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-3 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-3 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-3 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-3 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-3 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-3 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-3 div.sk-toggleable__content {
  display: none;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  display: block;
  width: 100%;
  overflow: visible;
}

#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-3 div.sk-label label.sk-toggleable__label,
#sk-container-id-3 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-3 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-3 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-3 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-3 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-3 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-3 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-3 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-3 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-3 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}

.estimator-table summary {
    padding: .5rem;
    font-family: monospace;
    cursor: pointer;
}

.estimator-table details[open] {
    padding-left: 0.1rem;
    padding-right: 0.1rem;
    padding-bottom: 0.3rem;
}

.estimator-table .parameters-table {
    margin-left: auto !important;
    margin-right: auto !important;
}

.estimator-table .parameters-table tr:nth-child(odd) {
    background-color: #fff;
}

.estimator-table .parameters-table tr:nth-child(even) {
    background-color: #f6f6f6;
}

.estimator-table .parameters-table tr:hover {
    background-color: #e0e0e0;
}

.estimator-table table td {
    border: 1px solid rgba(106, 105, 104, 0.232);
}

.user-set td {
    color:rgb(255, 94, 0);
    text-align: left;
}

.user-set td.value pre {
    color:rgb(255, 94, 0) !important;
    background-color: transparent !important;
}

.default td {
    color: black;
    text-align: left;
}

.user-set td i,
.default td i {
    color: black;
}

.copy-paste-icon {
    background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NDggNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNy4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjUgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTIwOCAwTDMzMi4xIDBjMTIuNyAwIDI0LjkgNS4xIDMzLjkgMTQuMWw2Ny45IDY3LjljOSA5IDE0LjEgMjEuMiAxNC4xIDMzLjlMNDQ4IDMzNmMwIDI2LjUtMjEuNSA0OC00OCA0OGwtMTkyIDBjLTI2LjUgMC00OC0yMS41LTQ4LTQ4bDAtMjg4YzAtMjYuNSAyMS41LTQ4IDQ4LTQ4ek00OCAxMjhsODAgMCAwIDY0LTY0IDAgMCAyNTYgMTkyIDAgMC0zMiA2NCAwIDAgNDhjMCAyNi41LTIxLjUgNDgtNDggNDhMNDggNTEyYy0yNi41IDAtNDgtMjEuNS00OC00OEwwIDE3NmMwLTI2LjUgMjEuNS00OCA0OC00OHoiLz48L3N2Zz4=);
    background-repeat: no-repeat;
    background-size: 14px 14px;
    background-position: 0;
    display: inline-block;
    width: 14px;
    height: 14px;
    cursor: pointer;
}
</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestClassifier(class_weight='balanced', max_depth=5, random_state=0)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" checked=""><label for="sk-estimator-id-3" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>RandomForestClassifier</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.7/modules/generated/sklearn.ensemble.RandomForestClassifier.html">?<span>Documentation for RandomForestClassifier</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted" data-param-prefix="">
        <div class="estimator-table">
            <details>
                <summary>Parameters</summary>
                
<table class="parameters-table caption-top table table-sm table-striped small">
<tbody>
<tr class="default odd">
<td><em></em></td>
<td class="param">n_estimators&nbsp;</td>
<td class="value">100</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">criterion&nbsp;</td>
<td class="value">'gini'</td>
</tr>
<tr class="user-set odd">
<td><em></em></td>
<td class="param">max_depth&nbsp;</td>
<td class="value">5</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">min_samples_split&nbsp;</td>
<td class="value">2</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">min_samples_leaf&nbsp;</td>
<td class="value">1</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">min_weight_fraction_leaf&nbsp;</td>
<td class="value">0.0</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">max_features&nbsp;</td>
<td class="value">'sqrt'</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">max_leaf_nodes&nbsp;</td>
<td class="value">None</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">min_impurity_decrease&nbsp;</td>
<td class="value">0.0</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">bootstrap&nbsp;</td>
<td class="value">True</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">oob_score&nbsp;</td>
<td class="value">False</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">n_jobs&nbsp;</td>
<td class="value">None</td>
</tr>
<tr class="user-set odd">
<td><em></em></td>
<td class="param">random_state&nbsp;</td>
<td class="value">0</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">verbose&nbsp;</td>
<td class="value">0</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">warm_start&nbsp;</td>
<td class="value">False</td>
</tr>
<tr class="user-set even">
<td><em></em></td>
<td class="param">class_weight&nbsp;</td>
<td class="value">'balanced'</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">ccp_alpha&nbsp;</td>
<td class="value">0.0</td>
</tr>
<tr class="default even">
<td><em></em></td>
<td class="param">max_samples&nbsp;</td>
<td class="value">None</td>
</tr>
<tr class="default odd">
<td><em></em></td>
<td class="param">monotonic_cst&nbsp;</td>
<td class="value">None</td>
</tr>
</tbody>
</table>

            </details>
        </div>
    </div></div></div></div></div><script>function copyToClipboard(text, element) {
    // Get the parameter prefix from the closest toggleable content
    const toggleableContent = element.closest('.sk-toggleable__content');
    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
    const fullParamName = paramPrefix ? `${paramPrefix}${text}` : text;

    const originalStyle = element.style;
    const computedStyle = window.getComputedStyle(element);
    const originalWidth = computedStyle.width;
    const originalHTML = element.innerHTML.replace('Copied!', '');

    navigator.clipboard.writeText(fullParamName)
        .then(() => {
            element.style.width = originalWidth;
            element.style.color = 'green';
            element.innerHTML = "Copied!";

            setTimeout(() => {
                element.innerHTML = originalHTML;
                element.style = originalStyle;
            }, 2000);
        })
        .catch(err => {
            console.error('Failed to copy:', err);
            element.style.color = 'red';
            element.innerHTML = "Failed!";
            setTimeout(() => {
                element.innerHTML = originalHTML;
                element.style = originalStyle;
            }, 2000);
        });
    return false;
}

document.querySelectorAll('.fa-regular.fa-copy').forEach(function(element) {
    const toggleableContent = element.closest('.sk-toggleable__content');
    const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
    const paramName = element.parentElement.nextElementSibling.textContent.trim();
    const fullParamName = paramPrefix ? `${paramPrefix}${paramName}` : paramName;

    element.setAttribute('title', fullParamName);
});
</script>
</div>
</div>
<p>Υπολογισμός για το train set:</p>
<div id="e8693605" class="cell" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predictions for the train set</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>y_pred_train <span class="op">=</span> rf_classifier_balanced.predict(X_train)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>cm_train <span class="op">=</span> confusion_matrix(y_train, y_pred_train)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>tn, fp, fn, tp <span class="op">=</span> cm_train.ravel().tolist()</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>train_accuracy <span class="op">=</span> (tp <span class="op">+</span> tn) <span class="op">/</span> (tp <span class="op">+</span> tn <span class="op">+</span> fp <span class="op">+</span> fn)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>train_precision <span class="op">=</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fp))</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>train_recall <span class="op">=</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fn))</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>train_f1_score <span class="op">=</span> <span class="dv">2</span> <span class="op">/</span> ((<span class="dv">1</span> <span class="op">/</span> train_precision) <span class="op">+</span> (<span class="dv">1</span> <span class="op">/</span> train_recall))</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>df_train_metrics_balanced <span class="op">=</span> pd.DataFrame({</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'train_accuracy'</span>: train_accuracy, </span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'train_precision'</span>: train_precision,</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'train_recall'</span>: train_recall,</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'train_f1_score'</span>: train_f1_score,</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>    },index<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>df_train_metrics_balanced</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">train_accuracy</th>
<th data-quarto-table-cell-role="th">train_precision</th>
<th data-quarto-table-cell-role="th">train_recall</th>
<th data-quarto-table-cell-role="th">train_f1_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>0.997782</td>
<td>0.995375</td>
<td>0.995375</td>
<td>0.995375</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Παρατηρώ πως έχουν αυξηθεί τόσο η ακρίβεια (99.5% -&gt; 99.8% όσο και η ανάκληση 90.0% -&gt; 99.5%).</p>
<p>Υπολογισμός για το test set:</p>
<div id="073784c1" class="cell" data-execution_count="32">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predictions for the test set</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>y_pred_test <span class="op">=</span> rf_classifier.predict(X_test)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>cm_test <span class="op">=</span> confusion_matrix(y_test, y_pred_test)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cm_test)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>tn, fp, fn, tp <span class="op">=</span> cm_test.ravel().tolist()</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>test_accuracy <span class="op">=</span> (tp <span class="op">+</span> tn) <span class="op">/</span> (tp <span class="op">+</span> tn <span class="op">+</span> fp <span class="op">+</span> fn)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>test_precision <span class="op">=</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fp))</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>test_recall <span class="op">=</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fn))</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>test_f1_score <span class="op">=</span> <span class="dv">2</span> <span class="op">/</span> ((<span class="dv">1</span> <span class="op">/</span> test_precision) <span class="op">+</span> (<span class="dv">1</span> <span class="op">/</span> test_recall))</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>df_test_metrics_balanced <span class="op">=</span> pd.DataFrame({</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'test_accuracy'</span>: test_accuracy, </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'test_precision'</span>: test_precision,</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'test_recall'</span>: test_recall,</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'test_f1_score'</span>: test_f1_score,</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>    },index<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>df_test_metrics_balanced</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1469    0]
 [   2  462]]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">test_accuracy</th>
<th data-quarto-table-cell-role="th">test_precision</th>
<th data-quarto-table-cell-role="th">test_recall</th>
<th data-quarto-table-cell-role="th">test_f1_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>0.998965</td>
<td>1.0</td>
<td>0.99569</td>
<td>0.99784</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Παρατηρώ πως η ακρίβεια (99.8% -&gt; 99.9) όσο και η ανάκληση (99.5% -&gt; 99.6%) αυξήθηκαν ελαφρά στο test set.</p>
</section>
<section id="ερώτημα-10" class="level3">
<h3 class="anchored" data-anchor-id="ερώτημα-10">Ερώτημα 10</h3>
<p>Περνάω επομένως στο x_unknown (55, 12):</p>
<div id="aec9cb30" class="cell" data-execution_count="33">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>y_unknown_proba <span class="op">=</span> rf_classifier.predict_proba(x_unknown)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"(y_unknown_proba is a </span><span class="sc">{</span><span class="bu">type</span>(y_unknown_proba)<span class="sc">}</span><span class="ss"> with dimensions </span><span class="sc">{</span>y_unknown_proba<span class="sc">.</span>shape<span class="sc">}</span><span class="ss"> and classes </span><span class="sc">{</span>rf_classifier<span class="sc">.</span>classes_<span class="sc">}</span><span class="ss">)."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(y_unknown_proba is a &lt;class 'numpy.ndarray'&gt; with dimensions (55, 2) and classes [0 1]).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/anton/Desktop/Data Science/MSc Data and Web Science/DWS101 Μηχανική Μάθηση/DWS101-Machine-Learning/Exercise4/venv/lib/python3.14/site-packages/sklearn/utils/validation.py:2742: UserWarning:

X has feature names, but RandomForestClassifier was fitted without feature names
</code></pre>
</div>
</div>
<p>Θα δημιουργήσω ένα dataframe για την αποθήκευση των νέων τιμών, για να δουλέψω πιο εύκολα:</p>
<div id="58aa823b" class="cell" data-execution_count="34">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create an empty dataframe</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>df_y_unknown_labelled <span class="op">=</span> pd.DataFrame()</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># populate it</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>df_y_unknown_labelled[<span class="st">'type'</span>] <span class="op">=</span> [<span class="st">'red'</span> <span class="cf">if</span> x<span class="op">&gt;</span><span class="fl">0.55</span> <span class="cf">else</span> <span class="st">'white'</span> <span class="cf">if</span> x<span class="op">&lt;</span><span class="fl">0.45</span>  <span class="cf">else</span> <span class="st">'unknown'</span> <span class="cf">for</span> x <span class="kw">in</span> y_unknown_proba[:, <span class="dv">1</span>]]</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>column_counts <span class="op">=</span> df_y_unknown_labelled.<span class="bu">apply</span>(pd.Series.value_counts)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(column_counts)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_y_unknown_labelled.shape)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         type
type         
unknown    19
white      18
red        18
(55, 1)</code></pre>
</div>
</div>
<p>Παρατηρώ πως οι πιθανότητες που έδωσα για τον διαχωρισμό είναι οριακές (<code>'red' if x&gt;0.55</code>) και (<code>'white' if x&lt;0.45</code>) και μου αφήνουν 19 δείγματα άγνωστα. Επομένως θα ενσωματώσω τα ετικετοποιημένα στο αρχικό dataframe και δεν θα συνεχίσω την ετικετοποίηση για αυτά τα 19 άγνωστα δείγματα.</p>
<div id="00670e84" class="cell" data-execution_count="35">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df_x_unknown <span class="op">=</span> pd.DataFrame(x_unknown)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>x_unknown.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>df_y_unknown_labelled.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>df_combined_labelled <span class="op">=</span> pd.concat([df_y_unknown_labelled, x_unknown], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>df_initial_labelled <span class="op">=</span> pd.concat([x_known, y_known], axis<span class="op">=</span><span class="dv">1</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns of df_initial_labelled to match df_combined_labelled</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>df_initial_labelled <span class="op">=</span> df_initial_labelled[df_combined_labelled.columns]</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># stack them</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>df_final <span class="op">=</span> pd.concat([df_combined_labelled, df_initial_labelled], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>df_final[<span class="st">'type'</span>] <span class="op">=</span> df_final[<span class="st">'type'</span>].replace({<span class="st">'white'</span>: <span class="dv">0</span>, <span class="st">'red'</span>: <span class="dv">1</span>, <span class="st">'unknown'</span>: <span class="dv">2</span>}).astype(<span class="bu">int</span>)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>df_final.head()</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>df_final.info()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 6497 entries, 0 to 6496
Data columns (total 13 columns):
 #   Column                Non-Null Count  Dtype  
---  ------                --------------  -----  
 0   type                  6497 non-null   int64  
 1   fixed acidity         6487 non-null   float64
 2   volatile acidity      6489 non-null   float64
 3   citric acid           6494 non-null   float64
 4   residual sugar        6495 non-null   float64
 5   chlorides             6495 non-null   float64
 6   free sulfur dioxide   6497 non-null   float64
 7   total sulfur dioxide  6497 non-null   float64
 8   density               6497 non-null   float64
 9   pH                    6488 non-null   float64
 10  sulphates             6493 non-null   float64
 11  alcohol               6497 non-null   float64
 12  quality               6497 non-null   int64  
dtypes: float64(11), int64(2)
memory usage: 660.0 KB</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>